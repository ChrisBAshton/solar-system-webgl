<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>CS32310 - Advanced Computer Graphics</title>
    </head>
    <body>

        <div id="canvas_solar_system__container">
            <canvas id="canvas_solar_system" class="canvas_solar_system"></canvas>
        </div>

        <style>
            body {
                background-color: #222;
            }

            h3 {
                margin: 0;
            }

            #canvas_solar_system__container {
                margin: 0 auto;
                max-width: 800px;
                width: 100%;
                padding: 20px;
                background-color: #fff;
            }
            
            #millisecondsPerDay {
                min-width: 300px;
            }

            #millisecondsPerDayInfo {
                text-align: center;
                font-style: italic;
            }

            .canvas_solar_system {
                display: block;
                margin: 20px auto;
                background-color: #000;
            }

            .canvas_solar_system--full_screen {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                z-index: 999;
                background-color: #000;
            }

            .webgl_solarsystem_gui__fieldset_container {
                margin-bottom: 10px;
            }

            .webgl_solarsystem_gui__fieldset_container--ambient, .webgl_solarsystem_gui__fieldset_container--sun {
                float: left;
                width: 50%;
            }

            .webgl_solarsystem_gui__fieldset_container fieldset {
                width: 100%;
                border: 0;
                padding: 0.1em;
            }

            .webgl_solarsystem_gui__fieldset_container fieldset label {
                width: 230px;
                display: inline-block;
                text-align: right;
                padding-right: 15px;
            }
            .webgl_solarsystem_gui__fieldset_container fieldset:first-child label {
                font-weight: bold;
            }
        </style>

        <!--
            precision mediump float; 

            varying vec3 normalInterp;
            varying vec3 vertPos;

            uniform int mode;

            const vec3 lightPos = vec3(1.0,1.0,1.0);
            const vec3 ambientColor = vec3(0.3, 0.0, 0.0);
            const vec3 diffuseColor = vec3(0.5, 0.0, 0.0);
            const vec3 specColor = vec3(1.0, 1.0, 1.0);

            void main() {
                vec3 normal = normalize(normalInterp);
                vec3 lightDir = normalize(lightPos - vertPos);
                vec3 reflectDir = reflect(-lightDir, normal);
                vec3 viewDir = normalize(-vertPos);

                float lambertian = max(dot(lightDir,normal), 0.0);
                float specular = 0.0;

                if(lambertian > 0.0) {
                   float specAngle = max(dot(reflectDir, viewDir), 0.0);
                   specular = pow(specAngle, 4.0);
                }
                gl_FragColor = vec4(ambientColor +
                                  lambertian*diffuseColor +
                                  specular*specColor, 1.0);
            }
        -->


        <script id="webgl_solarsystem__shader--fragment" type="x-shader/x-fragment">
            precision mediump float;
            varying vec2 vTextureCoord;
            varying vec3 vLightWeighting;
            uniform sampler2D uSampler;

            void main(void) {
                vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
                gl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a);
            }
        </script>

        <!--
            attribute vec3 inputPosition;
            attribute vec3 inputNormal;
            attribute vec2 inputTexCoord;

            uniform mat4 projection, modelview, normalMat;

            varying vec3 normalInterp;
            varying vec3 vertPos;

            void main(){
                gl_Position = projection * modelview * vec4(inputPosition, 1.0);
                vec4 vertPos4 = modelview * vec4(inputPosition, 1.0);
                vertPos = vec3(vertPos4) / vertPos4.w;
                normalInterp = vec3(normalMat * vec4(inputNormal, 0.0));
            }
        -->
        <script id="webgl_solarsystem__shader--vertex" type="x-shader/x-vertex">
            attribute vec3 aVertexPosition;
            attribute vec3 aVertexNormal;
            attribute vec2 aTextureCoord;
            uniform mat4 uMVMatrix;
            uniform mat4 uPMatrix;
            uniform mat3 uNMatrix;
            uniform vec3 uAmbientColor;
            uniform vec3 uPointLightingLocation;
            uniform vec3 uPointLightingColor;
            uniform bool uUseLighting;
            varying vec2 vTextureCoord;
            varying vec3 vLightWeighting;

            void main(void) {
                vec4 mvPosition = uMVMatrix * vec4(aVertexPosition, 1.0);
                gl_Position = uPMatrix * mvPosition;
                vTextureCoord = aTextureCoord;
                if (!uUseLighting) {
                    vLightWeighting = vec3(1.0, 1.0, 1.0);
                } else {
                    vec3 lightDirection = normalize(uPointLightingLocation - mvPosition.xyz);
                    vec3 transformedNormal = uNMatrix * aVertexNormal;
                    float directionalLightWeighting = max(dot(transformedNormal, lightDirection), 0.0);
                    vLightWeighting = uAmbientColor + uPointLightingColor * directionalLightWeighting;
                }
            }
        </script>

        <script src="js/lib/require.js" data-main="js/main.js"></script>
    </body>
</html>